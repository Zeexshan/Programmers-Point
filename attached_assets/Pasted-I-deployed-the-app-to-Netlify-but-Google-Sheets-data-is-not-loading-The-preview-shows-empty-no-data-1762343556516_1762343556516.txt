I deployed the app to Netlify but Google Sheets data is not loading. The preview shows empty/no data for courses, placements, and combinations. I've set all environment variables in Netlify. Please diagnose and fix the Google Sheets integration.**

---

## üîç **DIAGNOSTIC CHECKLIST:**

### **1. Verify Google Sheets API Setup**

**First, let me confirm the Google Sheets configuration is correct:**

**Check `client/src/utils/googleSheets.ts`:**

Please add extensive logging to understand what's failing:

```typescript
const SHEET_ID = import.meta.env.VITE_GOOGLE_SHEET_ID;
const API_KEY = import.meta.env.VITE_GOOGLE_API_KEY;

export async function readSheet(sheetName: string, range = 'A2:Z') {
  console.log('üîç readSheet called:', { sheetName, range });
  console.log('üìã SHEET_ID:', SHEET_ID ? `Set (${SHEET_ID.substring(0, 10)}...)` : '‚ùå MISSING');
  console.log('üîë API_KEY:', API_KEY ? `Set (${API_KEY.substring(0, 10)}...)` : '‚ùå MISSING');

  if (!SHEET_ID || !API_KEY) {
    console.error('‚ùå Missing credentials!');
    throw new Error('Missing SHEET_ID or API_KEY');
  }

  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${sheetName}!${range}?key=${API_KEY}`;
  
  console.log('üåê Fetching URL:', url.replace(API_KEY, 'API_KEY_HIDDEN'));

  try {
    const response = await fetch(url, {
      method: 'GET',
      headers: {
        'Accept': 'application/json'
      }
    });

    console.log('üì• Response status:', response.status);
    console.log('üì• Response ok:', response.ok);

    if (!response.ok) {
      const errorText = await response.text();
      console.error('‚ùå API Error Response:', errorText);
      
      let errorData;
      try {
        errorData = JSON.parse(errorText);
      } catch {
        errorData = { message: errorText };
      }
      
      console.error('‚ùå Parsed error:', errorData);
      throw new Error(errorData.error?.message || `HTTP ${response.status}: ${errorText}`);
    }

    const data = await response.json();
    console.log('‚úÖ Data received:', {
      hasValues: !!data.values,
      rowCount: data.values?.length || 0,
      firstRow: data.values?.[0]
    });

    return data.values || [];
  } catch (error) {
    console.error(`‚ùå Error reading ${sheetName}:`, error);
    throw error;
  }
}

export async function fetchAllData() {
  console.log('üöÄ fetchAllData started');
  
  try {
    const [technologies, combinations, companies, placements] = await Promise.all([
      readSheet('Technologies', 'A2:J').catch(e => {
        console.error('Technologies failed:', e);
        return [];
      }),
      readSheet('Combinations', 'A2:H').catch(e => {
        console.error('Combinations failed:', e);
        return [];
      }),
      readSheet('Companies', 'A2:D').catch(e => {
        console.error('Companies failed:', e);
        return [];
      }),
      readSheet('Placements', 'A2:I').catch(e => {
        console.error('Placements failed:', e);
        return [];
      })
    ]);

    console.log('üìä Raw data counts:', {
      technologies: technologies.length,
      combinations: combinations.length,
      companies: companies.length,
      placements: placements.length
    });

    const result = {
      technologies: technologies.map(row => ({
        name: row[0],
        mainCategory: row[1],
        subCategory: row[2],
        displayOrder: parseInt(row[3] || '0'),
        vacancies: parseInt(row[4] || '0'),
        fresherPackage: row[5] || '',
        experiencedPackage: row[6] || '',
        topCompanies: row[7] || '',
        popularityScore: parseInt(row[8] || '5'),
        description: row[9] || ''
      })),
      combinations: combinations.map(row => ({
        technologies: (row[0] || '').split(', '),
        jobRole: row[1] || '',
        category: row[2] || '',
        vacancies: parseInt(row[3] || '0'),
        fresherPackage: row[4] || '',
        experiencedPackage: row[5] || '',
        topCompanies: row[6] || '',
        popularityScore: parseInt(row[7] || '5')
      })),
      companies: companies.map(row => ({
        name: row[0] || '',
        logoUrl: row[1] || '',
        totalPlacements: parseInt(row[2] || '0'),
        avgPackage: row[3] || ''
      })),
      placements: placements.map(row => ({
        studentName: row[0] || '',
        company: row[1] || '',
        package: row[2] || '',
        phone: row[3] || '',
        photoUrl: row[4] || '',
        profile: row[5] || '',
        course: row[6] || '',
        review: row[7] || '',
        joiningDate: row[8] || ''
      }))
    };

    console.log('‚úÖ Processed data:', {
      technologies: result.technologies.length,
      combinations: result.combinations.length,
      companies: result.companies.length,
      placements: result.placements.length
    });

    return result;
  } catch (error) {
    console.error('üí• fetchAllData error:', error);
    throw error;
  }
}
```

---

### **2. Check Google Sheet Settings**

**The Google Sheet MUST be:**
- ‚úÖ Shared as "Anyone with the link can VIEW"
- ‚úÖ Has correct sheet names (case-sensitive!):
  - Technologies (not "Technology" or "technologies")
  - Combinations
  - Companies
  - Placements
  - Inquiries

**Please verify:**
1. Open the Google Sheet (use SHEET_ID from environment variable)
2. Click "Share" button
3. Ensure it says "Anyone with the link" ‚Üí "Viewer"
4. Check exact sheet tab names at bottom

---

### **3. Test Google Sheets API Directly**

**Create a test page to debug API:**

Create `client/src/pages/TestAPI.tsx`:

```typescript
import { useEffect, useState } from 'react';

export default function TestAPI() {
  const [result, setResult] = useState<any>(null);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    testAPI();
  }, []);

  async function testAPI() {
    const SHEET_ID = import.meta.env.VITE_GOOGLE_SHEET_ID;
    const API_KEY = import.meta.env.VITE_GOOGLE_API_KEY;

    console.log('Testing with:', { SHEET_ID, API_KEY: API_KEY?.substring(0, 10) + '...' });

    if (!SHEET_ID || !API_KEY) {
      setError('Missing SHEET_ID or API_KEY in environment variables!');
      return;
    }

    const testUrl = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Technologies!A1:J5?key=${API_KEY}`;

    try {
      console.log('Fetching:', testUrl.replace(API_KEY, 'KEY_HIDDEN'));
      const response = await fetch(testUrl);
      
      console.log('Response status:', response.status);
      
      if (!response.ok) {
        const errorText = await response.text();
        console.error('Error response:', errorText);
        setError(`API Error: ${response.status} - ${errorText}`);
        return;
      }

      const data = await response.json();
      console.log('Success! Data:', data);
      setResult(data);
    } catch (err: any) {
      console.error('Fetch error:', err);
      setError(err.message);
    }
  }

  return (
    <div className="p-8">
      <h1 className="text-2xl font-bold mb-4">Google Sheets API Test</h1>
      
      <div className="mb-4">
        <p><strong>SHEET_ID:</strong> {import.meta.env.VITE_GOOGLE_SHEET_ID || '‚ùå NOT SET'}</p>
        <p><strong>API_KEY:</strong> {import.meta.env.VITE_GOOGLE_API_KEY ? '‚úÖ SET' : '‚ùå NOT SET'}</p>
      </div>

      {error && (
        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
          <strong>Error:</strong> {error}
        </div>
      )}

      {result && (
        <div className="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded">
          <strong>Success!</strong>
          <pre className="mt-2 text-xs overflow-auto">
            {JSON.stringify(result, null, 2)}
          </pre>
        </div>
      )}

      <button 
        onClick={testAPI}
        className="mt-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"
      >
        Test Again
      </button>
    </div>
  );
}
```

**Add route in `App.tsx`:**
```typescript
<Route path="/test-api" element={<TestAPI />} />
```

**Then visit `/test-api` in the deployed Netlify site to see the actual error!**

---

### **4. Check Netlify Build Logs**

**In Netlify dashboard:**
1. Go to your site
2. Click "Deploys"
3. Click on the latest deploy
4. Check "Deploy log"
5. Look for any errors during build

**Common issues:**
- Environment variables not being set during build
- Build failing silently
- Missing dependencies

---

### **5. Common Google Sheets API Errors & Fixes**

| Error | Cause | Fix |
|-------|-------|-----|
| `403 Forbidden` | API key invalid or Sheet not public | Regenerate API key, make Sheet public |
| `404 Not Found` | Wrong Sheet ID | Double-check SHEET_ID |
| `400 Bad Request` | Wrong sheet name or range | Check sheet tab names (case-sensitive!) |
| `401 Unauthorized` | API key restrictions | Remove API key restrictions in Google Cloud |
| CORS error | (Shouldn't happen with Sheets API) | Check if using correct API endpoint |

---

### **6. Verify API Key Restrictions**

**In Google Cloud Console:**
1. Go to: https://console.cloud.google.com/apis/credentials
2. Find your API key
3. Click "Edit"
4. Check "API restrictions":
   - Should have "Google Sheets API" enabled
5. Check "Application restrictions":
   - For testing: Set to "None"
   - For production: Set to "HTTP referrers" and add your Netlify domain

---

### **7. Test in Browser Console**

**Once deployed, open browser console on Netlify site and run:**

```javascript
// Test direct API call
const SHEET_ID = 'YOUR_SHEET_ID_HERE';
const API_KEY = 'YOUR_API_KEY_HERE';

fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Technologies!A1:J5?key=${API_KEY}`)
  .then(r => r.json())
  .then(data => console.log('‚úÖ Success:', data))
  .catch(err => console.error('‚ùå Error:', err));
```

---

## üéØ **IMMEDIATE ACTIONS:**

**Priority 1:** Add the enhanced logging to `googleSheets.ts`

**Priority 2:** Create the `/test-api` page

**Priority 3:** Deploy to Netlify again with new logging

**Priority 4:** Open Netlify site, go to `/test-api`, and check browser console

**Priority 5:** Send me:
- The error message from `/test-api`
- Browser console logs
- Whether Sheet is public
- Sheet ID (first 10 characters)